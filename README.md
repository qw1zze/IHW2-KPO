# Калякин Дмитрий Александрович, БПИ226

## Приложение для управления заказами в ресторане

### Пользователи: Администартор и оыбчный пользователь

Администраторы могут добавлять и удалять блюда, а также менять значения полей стоимость, количество, время приготовления.

Пользователи могут добалвять блюда в заказ, оформлять заказ, отменять заказ до его приготовления и оплачивать его после готовки.

### Система обрабатывает заказы в многопоточном режиме, симулирая приготовления заказов.

### Проект написан с соблюдением принципов SOLID и ООП, используя также шаблоны проектирвоания.

## Запуск приложения

1. Запустить файл docker-compose.yaml для создания контейнера postgresql
2. Запустить файлы users.sql, tokens.sql, meals.sql, orders.sql для формирования таблиц в сессии
3. Запустить файл Application.kt

Программа должна корректно запуститься. В случае возникновения вопросов можно написать в ТГ: @ridimonn

### Отправка запросов осуществляется через Postman

## Описания фичей

### Регистрация
Для регистрации отправляется post запрос на http://localhost:8080/register c телом

{
  "login": "login",
  "password": "password",
  "isAdmin": true
}

Вводится логин, пароль, админ или нет. Система проверяет есть ли такой пользователь или находится он в системе. В случае успеха возращает токен пользователя.

### Авторизация 

Для авторизации отправляется post запрос на http://localhost:8080/login c телом

{
  "login": "login",
  "password": "password"
}

Вводится логи и пароль. Система проверяет есть ли такой пользователь, находится ли он уже в системе, верный ли пароль. В случае успеха возращает токен пользователя.

### Выход

Для выхода отправляется post запрос на http://localhost:8080/logout c телом

{
  "token": "token",
}

Вводится токен пользователя. Система проверяет находится ли пользователь в системе, в случае успеха токен удалется из бд.

### Действия пользователя, чей токен является токеном пользователя с isAdmin = true, то есть администратора

### Добавление блюда в меню

Для добавления отправляется post запрос на http://localhost:8080/addMeal c телом

{
  "token": "token",
  "name": "soup",
  "price": 150,
  "time": 10,
  "count": 4
}

Вводится токен админа, название, цена, время приготовления в секундах, количество. Система проверяет корректность и добавляет блюдо в бд.

### Удаление блюда из меню

Для удаления отправляется post запрос на http://localhost:8080/deleteMeal c телом

{
  "token": "token",
  "name": "soup"
}

Вводится токен админа и название блюда. Система проверяет корректность и удаляет блюдо из бд.

### Изменение цены блюда из меню

Для изменения цены отправляется post запрос на http://localhost:8080/changeMealPrice c телом

{
  "token": "token",
  "name": "soup",
  "price": 100
}

Вводится токен админа, название и цена. Система проверяет корректность и меняет цену у блюда.

### Изменение количества блюд из меню

Для изменения количества отправляется post запрос на http://localhost:8080/changeMealCount c телом

{
  "token": "token",
  "name": "soup",
  "count": 6
}

Вводится токен админа, название и количество. Система проверяет корректность и меняет количество у блюда.


### Изменение времени готовки блюд из меню

Для изменения времени отправляется post запрос на http://localhost:8080/changeMealTime c телом

{
  "token": "token",
  "name": "soup",
  "time": 6
}

Вводится токен админа, название и время. Система проверяет корректность и меняет время у блюда.

### Действия обычных пользователей

### Добавление блюда в заказ

Для добавления блюда отправляется post запрос на http://localhost:8080/addMealOrder c телом

{
  "token": "token",
  "meal": "soup"
}

Вводится токен, название блюда. Система проверяет корректность и добавляет одно блюдо в заказ.

### Отправка заказа

Для отправки заказа отправляется post запрос на http://localhost:8080/sendOrder c телом

{
  "token": "token"
}

Вводится токен пользователя. Система проверяет корректность и если есть новый заказ отправляет его в готовку.

### Отмена заказа

Для отмены заказа отправляется post запрос на http://localhost:8080/cancelOrder c телом

{
  "token": "token"
}

Вводится токен пользователя. Система проверяет корректность и если есть заказ в готовке, то отменяет его.

### Оплата заказа

Для оплаты заказа отправляется post запрос на http://localhost:8080/payOrder c телом

{
  "token": "token"
}

Вводится токен пользователя. Система проверяет корректность и если есть приготовленный заказ, то меняет статус на оплаченный.

### Запросы без токена

### Получение меню

Для получения меню отправляется get запрос на http://localhost:8080/getMenu.

Система отправляет ответ, содержащий в себе блюда и их цену.

### Получение заказов, только для администраторов

Для получения заказво отправляется post запрос на http://localhost:8080/getOrders c телом

{
  "token": "token"
}

Система проверяет токен и отправляет ответ, содержащий всю информацию о заказах.


## Описание

Хранение данных осуществляется с помощью PostgreSQL

Вводимые значения проверяются на корректность.

Использован шаблон проектирования Адаптер для простого и понятного обращения к базам данных.

Используется шаблон Состояния для реализации симулирования процесса готовки.

Используются Singletone для создания сущностей, через которые можно обращаться к одному и тому же объекту.

## Итого реализовано:

- Система аутентификации для двух типов пользователей: посетителей и администраторов.

- Администратор может добавлять и удалять блюда из меню, а также устанавливать их количество, цену и сложность выполнения (время, которое оно будет готовиться).

- Посетители могут составлять заказ, выбирая блюда из актуального меню.

- Заказы обрабатываются в отдельных потоках, симулируя процесс приготовления.

- Посетители могут добавлять блюда в существующий заказ, пока он находится в обработке.

- Посетители должны иметь возможность отменять заказ до того, как он будет готов.

- Система должна отображать актуальный статус заказа.

- По завершению выполнения заказа посетитель должен иметь возможность его оплатить.

- Сохраняется состояние программы: меню, заказы, пользователи в системе.
